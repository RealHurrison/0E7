import{d as F,r as y,u as V,a as _,o as B,c as T,b as n,w as c,e as S,F as A,f as g,E as v,g as R,x as W,h as z,i as M,j as N,p as U,k as P,l as q,m as Y,n as G,q as H,s as K,t as X,v as J}from"../js/pnpm.34536afd.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(l){if(l.ep)return;l.ep=!0;const s=t(l);fetch(l.href,s)}})();const Z=g("div",{class:"el-upload__text"},[S(" 拖动文件到此处,或者"),g("em",null,"点击此处上传")],-1),ee=F({__name:"MainForm",setup(a){const e=y({exploit_uuid:"",environment:"auto_pipreqs=True;",command:"",argv:"",platform:"",arch:"",filter:"",times:1}),t=y(!1),i=V(),l=y(),s=u=>{let o=u.name;return o.endsWith(".py")&&o.endsWith(".zip")&&o.endsWith(".tar")?(v({title:"Upload Failed",message:"You can only upload one Python file or compressed file!",type:"error",position:"bottom-right"}),!1):u.size/1024/1024>1024?(v({title:"Upload Failed",message:"The file size cannot exceed 1024MB!",type:"error",position:"bottom-right"}),!1):!0},d=u=>{l.value.clearFiles();const o=u[0];o.uid=R(),l.value.handleStart(o)},h=(u,o)=>{t.value=o.length>0;let r=u.name;(r.endsWith(".zip")||r.endsWith(".tar"))&&(e.value.environment="auto_pipreqs=True;")},x=(u,o)=>{t.value=o.length>0},C=()=>{var u;if(t.value)(u=l.value)==null||u.submit();else if(e.value.command!==""){const o=new FormData;for(const[r,b]of Object.entries(e.value))o.append(r,String(b));fetch("/webui/exploit",{method:"POST",body:o}).then(r=>r.json()).then(r=>{w(r)}).catch(r=>{f()})}else v({title:"你必须先上传一个文件或者指定指令！",message:"Please upload a file first!",type:"error",position:"bottom-right"})},w=u=>{v({title:"Upload Success",message:u.message,type:"success",position:"bottom-right"}),i.commit("push",u.exploit_uuid)},f=()=>{v({title:"Upload Failed",message:"The server cannot respond to your request!",type:"error",position:"bottom-right"})};return(u,o)=>{const r=_("el-input"),b=_("el-form-item"),p=_("el-option"),k=_("el-select"),O=_("el-input-number"),I=_("ElForm"),$=_("upload-filled"),L=_("el-icon"),Q=_("el-upload"),j=_("el-button");return B(),T(A,null,[n(I,{inline:!0,"label-width":120},{default:c(()=>[n(b,{label:"Exploit UUID"},{default:c(()=>[n(r,{name:"exploit_uuid",modelValue:e.value.exploit_uuid,"onUpdate:modelValue":o[0]||(o[0]=m=>e.value.exploit_uuid=m)},null,8,["modelValue"])]),_:1}),n(b,{label:"Environment"},{default:c(()=>[n(r,{name:"environment",modelValue:e.value.environment,"onUpdate:modelValue":o[1]||(o[1]=m=>e.value.environment=m)},null,8,["modelValue"])]),_:1}),n(b,{label:"Command"},{default:c(()=>[n(r,{name:"command",modelValue:e.value.command,"onUpdate:modelValue":o[2]||(o[2]=m=>e.value.command=m)},null,8,["modelValue"])]),_:1}),n(b,{label:"Argv"},{default:c(()=>[n(r,{name:"argv",modelValue:e.value.argv,"onUpdate:modelValue":o[3]||(o[3]=m=>e.value.argv=m)},null,8,["modelValue"])]),_:1}),n(b,{label:"Platform"},{default:c(()=>[n(k,{modelValue:e.value.platform,"onUpdate:modelValue":o[4]||(o[4]=m=>e.value.platform=m)},{default:c(()=>[n(p,{label:"ALL",value:""}),n(p,{label:"windows",value:"windows"}),n(p,{label:"freebsd",value:"freebsd"}),n(p,{label:"linux",value:"linux"}),n(p,{label:"darwin",value:"darwin"})]),_:1},8,["modelValue"])]),_:1}),n(b,{label:"Arch"},{default:c(()=>[n(k,{modelValue:e.value.arch,"onUpdate:modelValue":o[5]||(o[5]=m=>e.value.arch=m)},{default:c(()=>[n(p,{label:"ALL",value:""}),n(p,{label:"amd64",value:"amd64"}),n(p,{label:"386",value:"386"}),n(p,{label:"arm64",value:"arm64"})]),_:1},8,["modelValue"])]),_:1}),n(b,{label:"Filter"},{default:c(()=>[n(r,{name:"filter",modelValue:e.value.filter,"onUpdate:modelValue":o[6]||(o[6]=m=>e.value.filter=m)},null,8,["modelValue"])]),_:1}),n(b,{label:"Times"},{default:c(()=>[n(O,{min:-2,max:10,modelValue:e.value.times,"onUpdate:modelValue":o[7]||(o[7]=m=>e.value.times=m),class:"el-input-number"},null,8,["modelValue"])]),_:1})]),_:1}),n(Q,{class:"upload-demo",drag:"",action:"/webui/exploit","auto-upload":!1,data:e.value,ref_key:"uploadRef",ref:l,"on-success":w,"before-upload":s,"on-exceed":d,"on-change":h,"on-error":f,"on-remove":x,multiple:!1},{default:c(()=>[n(L,{class:"el-icon--upload"},{default:c(()=>[n($)]),_:1}),Z]),_:1},8,["data"]),n(j,{type:"primary",class:"ml-3",onClick:C},{default:c(()=>[S("提交")]),_:1})],64)}}});const te=a=>(U("data-v-adc14cba"),a=a(),P(),a),oe={id:"console-wrapper"},ne=te(()=>g("div",{id:"terminal"},null,-1)),le=[ne],ae=F({__name:"OutputPanel",setup(a){const e={foreground:"#F8F8F8",background:"#2D2E2C",selection:"#5DA5D533",black:"#1E1E1D",brightBlack:"#262625",red:"#CE5C5C",brightRed:"#FF7272",green:"#5BCC5B",brightGreen:"#72FF72",yellow:"#CCCC5B",brightYellow:"#FFFF72",blue:"#5D5DD3",brightBlue:"#7279FF",magenta:"#BC5ED1",brightMagenta:"#E572FF",cyan:"#5DA5D5",brightCyan:"#72F0FF",white:"#F8F8F8",brightWhite:"#FFFFFF"};let t;function i(f){l="",f.write(`
\r$ `)}var l="",s={help:{f:()=>{h()},description:"Prints this help message"},list:{f:()=>{x()},description:"List recent Submissions"}};const d=new W.FitAddon;z(()=>{var o;const f=new M.WebLinksAddon;t=new N.Terminal({fontSize:14,fontFamily:'"Cascadia Code", Menlo, monospace',theme:e,cursorBlink:!0,allowProposedApi:!0}),t.loadAddon(f),t.loadAddon(d),t.open(document.getElementById("terminal")),setTimeout(()=>{d.fit()},100),t.writeln(["   \x1B[3m Remote Execution Tool\x1B[0m is a tool that can execute python code online!",""," ┌ \x1B[1mFeatures\x1B[0m ──────────────────────────────────────────────────────────────────┐"," │                                                                            │"," │  \x1B[31;1mUpload your zip                         \x1B[32mPerformance\x1B[0m                       │"," │   RET enables you to pack the files       RET can respond to your input    │"," │   and auto install the dependencies.      in the console box.\x1B[0m              │"," │                                                                            │"," │  \x1B[33;1mAccessible                                            \x1B[0m                    │"," │   The process data is listed here.                                         │"," │                                                                            │"," └────────────────────────────────────────────────────────────────────────────┘",""].join(`
\r`)),h(),(o=document.querySelector(".xterm"))==null||o.addEventListener("wheel",r=>{t.buffer.active.baseY>0&&r.preventDefault()}),t.onData(r=>{switch(r){case"":t.write("^C"),i(t);break;case"\r":u(t,l),l="";break;case"":t.buffer.active.cursorX>2&&(t.write("\b \b"),l.length>0&&(l=l.substr(0,l.length-1)));break;default:(r>=String.fromCharCode(32)&&r<=String.fromCharCode(126)||r>=" ")&&(l+=r,t.write(r))}});const u=(r,b)=>{const p=b.trim().split(" ")[0];if(p.length>0){if(r.writeln(""),p in s){s[p].f();return}r.writeln(`${p}: command not found`)}i(r)};w()});const h=()=>{t.writeln(["Welcome to Remote Execution Tool! Try some of the commands below.","",...Object.keys(s).map(f=>`  ${f.padEnd(10)} ${s[f].description}`)].join(`
\r`)),i(t)},x=async()=>{const f=await fetch("/webui/exploit_show_output",{method:"POST",headers:{"Content-Type":"application/json"}}).then(u=>{if(u.status!=200){t.writeln("\x1B[41;1m Error \x1B[0m \x1B[1mWe can't connect to the remote server!\x1B[0m");return}return u.json()});f!==void 0&&f.result.reverse().forEach(o=>{o.status=="SUCCESS"?t.writeln(`\x1B[46;1m ID ${o.id} \x1B[0m\x1B[42;1m ${o.status} \x1B[0m \x1B[1mYour output:\x1B[0m\r`):t.writeln(`\x1B[46;1m ID ${o.id} \x1B[0m\x1B\x1B[41;1m  ${o.status}  \x1B[0m \x1B[1mYour output:\x1B[0m
\r`),t.writeln(`${o.output}`)}),i(t)},C=()=>{d.fit(),console.log(1)},w=()=>{window.addEventListener("resize",C)};return(f,u)=>(B(),T("div",oe,le))}});const D=(a,e)=>{const t=a.__vccOpts||a;for(const[i,l]of e)t[i]=l;return t},re=D(ae,[["__scopeId","data-v-adc14cba"]]),se=F({__name:"OutputTable",setup(a){const e=V(),t=y([]),i=s=>{e.dispatch("change",s)},l=q(()=>e.state.workerQueue);return Y(()=>e.state.workerQueue,s=>{s.forEach(d=>{if(t.value.push({uuid:d.uuid,output:d.output,status:d.status}),d.status==="Pending"){let h=setInterval(()=>{d.intv=h,i(d)},1e3)}})}),(s,d)=>{const h=_("ElTableColumn"),x=_("ElTable");return B(),G(x,{height:425,data:l.value},{default:c(()=>[n(h,{label:"UUID",prop:"uuid"}),n(h,{label:"Status",prop:"status"}),n(h,{label:"Output",prop:"content"})]),_:1},8,["data"])}}}),ue=a=>(U("data-v-c23b4fc6"),a=a(),P(),a),ie=ue(()=>g("header",null,[g("h1",{style:{"text-align":"center","margin-bottom":"40px"}},"远程执行工具")],-1)),ce=F({__name:"App",setup(a){return(e,t)=>{const i=_("el-tab-pane"),l=_("el-tabs");return B(),T(A,null,[ie,g("main",null,[n(ee),n(l,{type:"border-card",class:"border-card"},{default:c(()=>[n(i,{label:"命令行"},{default:c(()=>[n(re)]),_:1}),n(i,{label:"表格"},{default:c(()=>[n(se)]),_:1})]),_:1})])],64)}}});const de=D(ce,[["__scopeId","data-v-c23b4fc6"]]),me=H({state(){return{workerQueue:[]}},mutations:{push(a,e){a.workerQueue=[{status:"Pending",uuid:e,content:""},...a.workerQueue]},change(a,e){const t=a.workerQueue.findIndex(i=>i.uuid===e.uuid);if(t!==-1){a.workerQueue[t].content=e.content,a.workerQueue[t].status=e.STATUS;let i=a.workerQueue[t];a.workerQueue.splice(t,1),a.workerQueue.unshift(i)}}},actions:{change({commit:a},e){fetch("/webui/exploit_show_output",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`exploit_uuid=${e.uuid}`}).then(t=>t.json(),t=>{v({title:"与目标主机失去连接，请重试",message:t,type:"error"}),clearInterval(e.intv)}).then(t=>{t.result!==null&&(t=t.result[0],e.content=t.output,e.STATUS=t.status,a("change",e),clearInterval(e.intv))})}},getters:{top(a){return a.workerQueue[a.workerQueue.length-1]}}}),E=K(de);for(const[a,e]of Object.entries(X))E.component(a,e);E.use(me);E.use(J);E.mount("#app");
